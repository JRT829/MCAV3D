<!DOCTYPE html>
<html>
  <head>
    <title>Simple Map</title>
    <meta name="viewport" content="initial-scale=1.0">
    <meta charset="utf-8">
    <link rel="shortcut icon" href="#" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
 
  </head>
  <body>
    <div id="map"></div>
    <div id="tram"></div>
  
 
  <script src="{{url_for('static', filename='js/main.js')}}"></script>
  
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCJcC-iTbiurisPUUqn6dd3LVtadL57XEI&callback=initMap"
    async defer></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.5.0/socket.io.js"  ></script>
    <script >
  
      let coordinates='fhewiofhewofieowhfiowefhioewhfiowfhiowefhwiofhwoiefhiowfhewoifheiwofhwiofhwoifhweoifweoifiowfhwiorhwoifeiowfhwiofwhoifhwoifehwoifwihfiowfhio'
      let coord_temp= document.getElementById('tram').innerHTML
     coord_temp=coordinates
      let socket = io('http://localhost:5000');
      socket.on('connect', function(){
        console.log('connected')
        socket.emit('my event', {data: 'I\'m connected!'});
        
        });
        
        function deleteMarkers(){
              for(i=0; i<markers.length;i++){
              markers[i].setMap(null);
              }
              markers = [];
              }

        const wait = (ms) => new Promise(resolve => setTimeout(resolve, ms))
        const loop = async () => {
       
       let connected=true
       
       while(connected==true){
      
        
        let markers=[]
      socket.emit('spawn')
      socket.on('tram',function(coordinates){
        
        console.log(coordinates)
        let latitude=coordinates[0]
        let longitude=coordinates[1]
        
        
        
        
        
        for(let i=0;i<latitude.length;i++){
          let marker=new google.maps.Marker({  
              map: map,      
                })

            markers.push(marker) 
          myLatlng=new google.maps.LatLng(latitude[i],longitude[i])
          markers[i].setPosition(myLatlng)
          markers[i].setTitle(i.toString())
          
          
        }
        //socket.emit('points',markers)
         }

        
        )

      
      await wait(3000)
      

       }
      }
      loop()
        
     

      
        

    </script>
    
    
  </body>

  